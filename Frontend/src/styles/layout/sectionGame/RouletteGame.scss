@use "../../core/variables" as var;

.roulette {
  grid-area: roulette;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0.75rem;
  margin-bottom: 1rem;
  width: min(100%, 420px);
  margin-inline: auto;
  --scale: clamp(210px, min(78vw, 42vh), 330px);
  --btn-size: calc(var(--scale) * 0.16);
  --label-font: calc(var(--scale) * 0.035);
  --label-distance: calc(var(--scale) * 0.16);
  --indicator-width: calc(var(--scale) * 0.28);
  --indicator-height: calc(var(--scale) * 0.18);
  --indicator-offset: calc(var(--scale) * -0.07);

  @media (min-width: var.$media_desktop) {
    margin-bottom: 1rem;
    --scale: clamp(300px, min(56vw, 60vh), 400px);
  }
  @media (min-width: var.$media_desktop_lg) {
    --scale: clamp(380px, min(30vw, 62vh), 480px);
  }

  &__indicator {
    width: var(--indicator-width);
height: var(--indicator-height);
margin-bottom: var(--indicator-offset);
    z-index: 30;
    background: url("../../../images/arrow-transparent.svg") no-repeat center;
    background-size: contain;

    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.9));

    transform-origin: center bottom;
  }

  &__indicator--active {
    animation: roulette-indicator-active 0.5s ease-out;
    animation-iteration-count: 4; // 4 latidos ‚âà 2s
  }

  &__wheel {
    position: relative;
    width: var(--scale);
    height: var(--scale);
    border-radius: 50%;
    overflow: hidden;

    // üé® fondo interior c√°lido (debajo de los gajos)
    background: radial-gradient(
      circle at 50% 40%,
      #fff8d1 0%,
      lighten(var.$color-accent-1, 15%) 40%,
      var.$color-accent-1 70%,
      darken(var.$color-accent-1, 5%) 80%
    );

    // sombra general de la ruleta
    box-shadow: 0 0px 15px rgba(0, 0, 0, 0.95);

    &--btn {
      width: calc(var(--btn-size) * 1.18);
      height: calc(var(--btn-size) * 0.92);
      padding: 0;

      font-size: calc(var(--btn-size) * 0.22);
      border-width: calc(var(--btn-size) * 0.06);
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      border-radius: 50%;
      font-family: var.$font_family_comic;
      font-weight: var.$font_weight_bold;
      z-index: 50;
      // fondo azul ‚Äúgomoso‚Äù
      background: radial-gradient(
        circle at 30% 20%,
        #e5f1ff 0%,
        // brillo fuerte
        lighten(var.$color-primary, 10%) 40%,
        var.$color-primary 80%
      );
      border: 3px solid var.$color-accent-1; // aro amarillo
      color: var.$color-accent-1;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      cursor: pointer;
      z-index: 50;

      box-shadow: 0 6px 8px rgba(0, 0, 0, 0.6),
        inset 0 4px 5px rgba(255, 255, 255, 0.85),
        inset 0 -4px 5px rgba(0, 0, 0, 0.45);

      animation: none;

      &::after {
        content: "";
        position: absolute;
        inset: -6px;
        background: rgba(255, 255, 255, 0.25);
        border-radius: 50%;
        pointer-events: none;

        // ‚úÖ m√°scara para que sea un anillo (no un disco)
        -webkit-mask: radial-gradient(
          farthest-side,
          transparent calc(100% - 10px),
          #000 calc(100% - 9px)
        );
        mask: radial-gradient(
          farthest-side,
          transparent calc(100% - 10px),
          #000 calc(100% - 9px)
        );
        transform: scale(1);
        filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.9));
      }

      // Animaci√≥n SOLO cuando est√° habilitado (turno jugador)
      &:not(:disabled)::after {
        animation: roulette-btn-pulse 1.1s ease-in-out infinite;
      }

      // Cuando est√° disabled, se para
      &:disabled::after {
        animation: none;
        filter: none;
      }

      &:active {
        box-shadow: 0 3px 4px rgba(0, 0, 0, 0.5),
          inset 0 2px 3px rgba(255, 255, 255, 0.7),
          inset 0 -2px 3px rgba(0, 0, 0, 0.5);
      }

      &:disabled {
        cursor: not-allowed;
        filter: grayscale(85%);
        box-shadow: none;
        pointer-events: none;
      }

      &:disabled:active {
        box-shadow: none;
        transform: translate(-50%, -50%);
      }
    }

    &--active {
      animation: roulette-wheel-pulse 2s ease-in-out infinite;
    }
  }

  &__wheelInner {
    position: absolute;
    inset: 0; // ocupa todo dentro del c√≠rculo
    border-radius: 50%;
    transform-origin: center center;

    transition: transform 4s ease-out; // o lo que tuvieses
  }

  &__wheel::before {
    content: "";
    position: absolute;
    inset: 0; // ocupa todo el c√≠rculo
    border-radius: 50%;
    pointer-events: none;

    // üé® degradado dorado estilo ‚Äúgomoso‚Äù como la flecha
    background: radial-gradient(
      circle at 30% 20%,
      // luz arriba-izquierda
      #fffbe9 0%,
      #ffe08f 30%,
      #ffc34a 55%,
      #f29b23 75%,
      #b86a10 100%
    );

    // üß≤ usamos m√°scara para que solo se vea el ARO
    -webkit-mask: radial-gradient(
      farthest-side,
      transparent calc(100% - 10px),
      #000 calc(100% - 4px)
    );
    mask: radial-gradient(
      farthest-side,
      transparent calc(100% - 10px),
      #000 calc(100% - 4px)
    );

    // ‚ú® brillo arriba + sombra abajo, como la flecha
    box-shadow: inset 0 4px 6px rgba(255, 255, 255, 0.9),
      // luz superior
      inset 0 -5px 8px rgba(0, 0, 0, 0.55); // sombra inferior
  }
  &__slice {
    position: absolute;
    left: 50%;
    bottom: 50%;
    transform-origin: bottom center;
    width: var(--slice-width);
    height: var(--slice-height);
    clip-path: polygon(50% 100%, 0 0, 100% 0);
    background-color: rgba(0, 0, 0, 0.3);
  }
  &__slice::before {
    content: "";
    position: absolute;
    inset: 2px; // grosor del borde
    clip-path: inherit; // mismo tri√°ngulo
    background-color: var(--wedge-color);
  }

  &__slice::after {
  content: "";
  position: absolute;

  /* El borde exterior del gajo es el "top: 0" */
  top: 0;
  left: 0;

  /* Centramos el punto sobre la l√≠nea del borde */
  transform: translate(-50%, -50%);

  /* ‚úÖ tama√±o proporcional a la ruleta */
  width: calc(var(--scale) * 0.025);
  height: calc(var(--scale) * 0.025);
  border-radius: 50%;

  background: radial-gradient(
    circle at 30% 30%,
    #f3efb5 0%,
    #f7f7c5 35%,
    #dad594 70%,
    #e2cf25 100%
  );

  box-shadow: 0 0 3px rgba(0, 0, 0, 0.9),
    inset 0 1px 1px rgba(247, 207, 99, 0.8);

  pointer-events: none;
  z-index: 20;
}


  // Amarillo (brillo fuerte)
  &__slice--yellow::before {
    background-image: linear-gradient(
      to top,
      #e9a800,
      // un pel√≠n m√°s oscuro
      var(--color-wedge-yellow) 40%,
      #fff3a8 // luz fuerte arriba
    );
    box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.8),
      inset 0 -2px 3px rgba(0, 0, 0, 0.25);
  }

  // Verde (m√°s ‚Äúgomoso‚Äù)
  &__slice--green::before {
    background-image: linear-gradient(
      to top,
      #4b8f3a,
      var(--color-wedge-green) 45%,
      #c4f3a4
    );
    box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.7),
      inset 0 -3px 4px rgba(0, 0, 0, 0.3);
  }

  // Azul (rollo pl√°stico brillante)
  &__slice--blue::before {
    background-image: linear-gradient(
      to top,
      #1a6f93,
      var(--color-wedge-blue) 50%,
      #b4f0ff
    );
    box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.85),
      inset 0 -2px 4px rgba(0, 0, 0, 0.35);
  }

  // Naranja
  &__slice--orange::before {
    background-image: linear-gradient(
      to top,
      #c35a24,
      var(--color-wedge-orange) 45%,
      #ffd0a0
    );
    box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.8),
      inset 0 -3px 4px rgba(0, 0, 0, 0.3);
  }

  // Rosa
  &__slice--pink::before {
    background-image: linear-gradient(
      to top,
      #b62547,
      var(--color-wedge-pink) 45%,
      #ffc0d4
    );
  }

  // Morado
  &__slice--purple::before {
    background-image: linear-gradient(
      to top,
      #5d279d,
      var(--color-wedge-purple) 45%,
      #e2c3ff
    );
  }

  // Negro (QUIEBRA) m√°s mate
  &__slice--black::before {
    background-image: linear-gradient(to top, #555, #3b3b3b 40%, #111);
  }

  // Dorado (MISTERIO / SUPERPREMIO)
  &__slice--gold::before {
    background-image: linear-gradient(
      to top,
      #c27a00,
      var(--color-wedge-gold) 45%,
      #ffe7a3
    );
    box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.85),
      inset 0 -3px 4px rgba(0, 0, 0, 0.35);
  }

  // Plata (PIERDE TURNO)
  &__slice--silver::before {
    background-image: linear-gradient(
      to top,
      #8c939a,
      var(--color-wedge-silver) 50%,
      #f5f7fa
    );
  }
  // üÉè Comod√≠n (azul el√©ctrico especial)
  &__slice--joker::before {
    background-image: linear-gradient(
      to top,
      #1f4fd8,
      // sombra profunda abajo
      var(--color-wedge-joker) 45%,
      #cfe2ff // brillo arriba
    );

    box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.9),
      inset 0 -3px 5px rgba(0, 0, 0, 0.4), 0 0 6px rgba(58, 134, 255, 0.6); // glow sutil
  }

  &__label {
    font-weight: var.$font_weight_bold;
    position: absolute;
    left: 50%;
    top: var(--label-distance);
    font-size: var(--label-font);
    transform: translate(-50%, -50%) rotate(-90deg);
    transform-origin: center;

    text-align: center;
    white-space: nowrap;
    pointer-events: none;
    text-shadow: -1px -1px 0 rgba(255, 255, 255, 0.5),
      // borde blanco arriba-izquierda
      1px -1px 0 rgba(255, 255, 255, 0.5),
      // borde blanco arriba-dcha
      -1px 1px 0 rgba(255, 255, 255, 0.5),
      // borde blanco abajo-izq
      1px 1px 0 rgba(255, 255, 255, 0.5),
      // borde blanco abajo-dcha
      0 2px 3px rgba(0, 0, 0, 0.45); // sombrita para volumen
  }
}

// Animaci√≥n indicador
@keyframes roulette-indicator-active {
  0% {
    transform: scale(1) translateY(0);
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.9));
  }
  50% {
    transform: scale(1.18) translateY(3px);
    filter: drop-shadow(0 6px 10px rgba(0, 0, 0, 1));
  }
  100% {
    transform: scale(1) translateY(0);
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.9));
  }
}

// Animacion de bot√≥n Tirar para el turno del jugador
@keyframes roulette-btn-pulse {
  0% {
    transform: scale(1);
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.9));
  }
  50% {
    transform: scale(1.18);
    filter: drop-shadow(0 6px 10px rgba(0, 0, 0, 1));
  }
  100% {
    transform: scale(1);
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.9));
  }
}

// Animacion Ruleta cuando le toca al jugador
@keyframes roulette-wheel-pulse {
  0% {
    transform: scale(1);
    filter: drop-shadow(0 0 0 rgba(0, 0, 0, 0));
  }
  50% {
    transform: scale(1.015);
    filter: drop-shadow(0 10px 18px rgba(0, 0, 0, 0.45));
  }
  100% {
    transform: scale(1);
    filter: drop-shadow(0 0 0 rgba(0, 0, 0, 0));
  }
}
